.Start TuplePlayer

CS: .Integer #0   ;Current State

Tape: .Character '0' ;Tape data.
endTape: .Character '3' ;End tape.

tupleStart: .Tuple 0 0 0 1 r ;Start position of the tape.
endTuple:   .Tuple 0 3 1 C r
space: .Character ' '


TuplePlayer: movar Tape r0
TupleReader: movar tupleStart r1
             jmp TupleTester
TupleDataR:  movar endTape r2
             cmprr r0 r2
             jmpp printTape
             jmp TupleReader

TupleTester: movxr r1 r2
             movmr CS r3
             cmprr r2 r3
             jmpz StateEquals
             addir #5 r1
             jmp BadTuple
StateEquals: addir #1 r1
             movxr r1 r2
             movxr r0 r3
             cmprr r2 r3
             jmpz TupleEquals
             addir #4 r1
             jmp BadTuple
TupleEquals: addir #1 r1
             movxr r1 r2
             movrm r2 CS
             addir #1 r1
             movxr r1 r3
             movrx r3 r0
             addir #1 r1
             movxr r1 r2
             cmpir #0 r2
             jmpz SubFro
             addir #1 r0
             jmp outFro
SubFro:      subir #1 r0
outFro:      jmp TupleDataR

BadTuple: movar endTuple r2
          addir #5 r2
          cmprr r1 r2
          jmpz Error
          jmp TupleTester
          halt

printTape: movar Tape r1
           movar endTape r2
prnt:      movxr r1 r3
           outcr r3
           movmr space r3
           outci r3
           cmprr r1 r2
           jmpz End
           addir #1 r1
           jmp prnt
End:       outci #10
           halt

noTulpesError: .String "No Tuples Match."
Error: halt
.end
